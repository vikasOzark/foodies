{% extends 'base.html' %}
{% block title %}Foodie GEN | Menu{% endblock title %}
{% block menu%}text-red-600{%endblock %}
{% block content %}
{% load static %}

<link rel="stylesheet" href="{% static 'css/menu_.css' %}" />

<div id="default-carousel" class="relative z-0" data-carousel="static">
  <!-- Carousel wrapper -->
  <div class="relative h-56 overflow-hidden mb-5 md:h-96">
    <!-- Item 1 -->
    <div class="hidden duration-700 ease-in-out" data-carousel-item>
      <span
        class="absolute text-2xl font-semibold text-white -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2 sm:text-3xl dark:text-gray-800">First
        Slide</span>
      <img src="{% static 'images/crousel-1.jpg' %}"
        class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2" alt="...">
    </div>
    <!-- Item 2 -->
    <div class="hidden duration-700 ease-in-out" data-carousel-item>
      <img src="{% static 'images/crousel-2.jpg' %}"
        class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2" alt="...">
    </div>
    <!-- Item 3 -->
    <div class="hidden duration-700 ease-in-out" data-carousel-item>
      <img src="{% static 'images/crousel-3.jpg' %}"
        class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2" alt="...">
    </div>
  </div>
  <!-- Slider indicators -->
  <div class="absolute z-30 flex space-x-3 -translate-x-1/2 bottom-5 left-1/2">
    <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 1"
      data-carousel-slide-to="0"></button>
    <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 2"
      data-carousel-slide-to="1"></button>
    <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 3"
      data-carousel-slide-to="2"></button>
  </div>
  <!-- Slider controls -->
  <button type="button"
    class="absolute top-0 left-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
    data-carousel-prev>
    <span
      class="inline-flex items-center justify-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
      <svg aria-hidden="true" class="w-5 h-5 text-white sm:w-6 sm:h-6 dark:text-gray-800" fill="none"
        stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      <span class="sr-only">Previous</span>
    </span>
  </button>
  <button type="button"
    class="absolute top-0 right-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
    data-carousel-next>
    <span
      class="inline-flex items-center justify-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
      <svg aria-hidden="true" class="w-5 h-5 text-white sm:w-6 sm:h-6 dark:text-gray-800" fill="none"
        stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
      <span class="sr-only">Next</span>
    </span>
  </button>
</div>

<div class="container lg:max-w-screen-lg mx-auto md:px-5 lg:px-5 mb-5">

  {% comment %} carousel start {% endcomment %}


  <div class="container lg:max-w-screen-lg mx-auto px-5">
    <nav class="pb-3 border-gray-200 rounded z-20">
      <button id="dropdownDefaultButton" data-dropdown-toggle="dropdown-filter"
        class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2.5 text-center inline-flex items-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
        type="button">Filter <svg class="w-4 h-2 ml-2" aria-hidden="true" fill="none" stroke="currentColor"
          viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg></button>
      <!-- Dropdown menu -->
      <div id="dropdown-filter" class="z-10 hidden bg-white divide-y divide-gray-100 rounded-lg shadow w-44 border">
        <ul class="py-2 text-sm text-gray-7000" aria-labelledby="dropdownDefaultButton">
          <li>
            <a href="{% url 'menu' 'all' %}"
              class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">All items</a>
          </li>
          <li>
            <a href="{% url 'menu' 'veg' %}"
              class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Veg only</a>
          </li>
          <li>
            <a href="{% url 'menu' 'non_veg' %}"
              class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Non veg only</a>
          </li>
          {% comment %} <li>
            <a href="#"
              class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">brekfast</a>
          </li>
          <li>
            <a href="#" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">lunch</a>
          </li>
          <li>
            <a href="#"
              class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">dinner</a>
          </li> {% endcomment %}
        </ul>
      </div>
      {% if slug %}
      {% include 'components/chips.html' with filter=slug %}
      {% endif %}
    </nav>
    <!-- content section  -->
    <div class="grid md:grid-cols-3 sm:grid-cols-2 lg:grid-cols-4 gap-4 scrolling-wrapper">
      {% for items in menu_model %}
        <!-- {% include '' with with image=items.image.url price=items.discounted old_price=items.price
        title=items.name type=items.type_of disc=items.deatil url=items.get_absolute_url %} -->
        <div class="cursor-pointer rounded-xl bg-white p-1 shadow-lg hover:shadow-lg">
          <a href="{{items.get_absolute_url}}">
            <div class="relative flex items-end overflow-hidden rounded-lg">
              <img src="{{items.image.url}}" alt="wallpaper" />
        
              <div class="absolute bottom-3 left-3 inline-flex items-center rounded-lg bg-white p-1 shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                  <path
                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                </svg>
        
                <span class="ml-1 text-sm text-slate-400">4.9</span>
              </div>
            </div>
        
            <div class="mt-1 p-2 ">
              {% if  items.type_of == 'veg' %}
                <img class="h-5 w-5 float-right" src="{% static 'images/assets/veg.png' %}" alt="veg">
              {% else %}
                <img class="h-5 w-5 float-right" src="{% static 'images/assets/nonveg.png' %}" alt="non veg">
              {% endif %}
              <h2 class="text-slate-700">{{items.name}}</h2>
              <p class="mt-1 text-sm text-slate-400">{{items.deatil}}</p>
        
              <div class="mt-3 flex items-end justify-between">
                <a onclick="addItem(this)" id="{{items.id}}" class="hover:bg-red-400 py-1 px-4 rounded shadow bg-red-600 ease-in-out text-white font-bold">Add
                  now</a>
        
                <p>
                  <span class="text-lg font-bold text-orange-500">{{items.discounted}}</span> /
                  <span class="text-sm text-slate-400">{{items.price}}</span>
                </p>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
      <!-- <div class="col-sm-8"> -->
      <!-- <div class="d-flex justify-content-center row p-3">
        {% for items in menu_model %}
        <div class="col-sm-12 col-md-3 m-2 float-left card float-x mb-2 p-1 ">
          <img src="{{items.image.url}}" class="img-thumbnail border-0" style="width:auto;height:45%" alt="..." />
          <div class="card-" style="height: fit-content;">
            <h5 class="card-title">
              {{ items.name }}
                      
              <input type="hidden" value="{{items.id}}" id="input{{items.id}}" />

              {% if  user.is_authenticated %}
              <a class="float-end" id="fav{{items.id}}">
                <div class="border-fav p-2">
                  <svg
                    id="fav-icon{{items.id}}"
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    
                        {% for favotive in fav %}
                          {% if favotive.dish_name.id == items.id %}
                            fill="red"
                          {% endif %}
                          fir=""
                        {% endfor %}   
                            
                    
                    height="16"
                    class="bi bi-bookmark-heart-fill"
                    viewBox="0 0 16 16">
                    <path
                      d="M2 15.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v13.5zM8 4.41c1.387-1.425 4.854 1.07 0 4.277C3.146 5.48 6.613 2.986 8 4.412z"
                    />
                  </svg>
                </div>
              </a>
              {% endif %}
            </h5>
            <p class="card-text">{{items.deatil}}</p>
            <a href="{% url 'deatail-view' items.id %}" class="btn btn-outline-info bg-gradient"
              >View Deatil</a>

              {% if user.is_authenticated %}
              <button data="hello" class="btn btn-primary bg-gradient" id='add-dabba{{items.id}}'>
                
                {% for cart in is_cart %}
                  {% if cart.item.id == items.id %}
                    Added
                  {% else %}
                    Cart
                  {% endif %}
                {% endfor %} 
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag-plus-fill" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M10.5 3.5a2.5 2.5 0 0 0-5 0V4h5v-.5zm1 0V4H15v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4h3.5v-.5a3.5 3.5 0 1 1 7 0zM8.5 8a.5.5 0 0 0-1 0v1.5H6a.5.5 0 0 0 0 1h1.5V12a.5.5 0 0 0 1 0v-1.5H10a.5.5 0 0 0 0-1H8.5V8z"/>
                </svg></button>
                {% else %}

                <button type="button" class="btn btn-primary ps-3 pe-3"
                  data-bs-toggle="tooltip" data-bs-placement="top"
                  data-bs-custom-class="custom-tooltip"
                  data-bs-title="Please login first ">
                  Add cart
                </button>
                {% endif %}
                  
                <div class="mt-1 p-1">
                  <div class="border rounded p-2 bg-success bg-opacity-10">
                    <p class="text-success m-0 "><strong>Get 5% off on order 2</strong></p>
                  </div>
                </div>
          </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="https://cdn.lordicon.com/lusqsztk.js"></script>
        
        <script>
          
            $("#fav{{items.id}}").click(function() {
              let prod_id = $("#input{{items.id}}").val();
              _id = { item_id: prod_id };

              $.ajax({
                url: '{% url "add-favorite" %}',
                method: "GET",
                data: _id,
                dataType: "json",
                success: function (data) {
                  if (data.status == "Save") {
                    $("#fav-icon{{items.id}}").attr("fill", data.data_coming);
                  }

                  if (data.status == "Deleted") {
                    $("#fav-icon{{items.id}}").attr("fill", data.data_coming);
                  }
                },
              });
            });
            // cart adding function
            $('#add-dabba{{items.id}}').click(function(){
              let prod_id = $("#input{{items.id}}").val();

              id = {
                dish_id : prod_id
              }
              $.ajax({
                url : "{% url 'Add_to_dabba' %}",
                method : 'GET',
                data : id,
                dataType : 'json',
                success : function(data){
                  if(data.status == 'delete'){
                    $('#add-dabba{{items.id}}').html('')
                    $('#add-dabba{{items.id}}').html(data.is_cart)
                  };
                  if (data.status == 'save'){
                    $('#add-dabba{{items.id}}').html('')
                    $('#add-dabba{{items.id}}').html(data.is_cart)
                    
                  }
                }
              })
            })
        </script>
        {% empty %}
        <div class="alert alert-primary" role="alert">
          Don't have any favorite item marked !
        </div>
        {% endfor %}
      </div> -->
      <!-- </div> -->
    </div>
  </div>
</div>

<!-- <script src="{% static 'js/ajax.js' %}"></script> -->
<!-- {% include 'js/add_js.html' %} -->

<script>
  // adding to the cart
function addItem(event){
  console.log(event)
    var dish_id = event.id
    console.log(dish_id)
    id = {
      dish_id : dish_id
    }
    $.ajax({
      url : "{% url 'Add_to_dabba' %}",
      method : 'GET',
      data : id,
      dataType : 'json',
      success : function(data){
        let message = document.getElementById('alert-message');
        updateCart()
        if(data.status == 204){
          message.innerHTML = `{% include 'components/alert.html' with type='Removed' message='Removed from cart !' %}`
        };
        if (data.status == 200){
          message.innerHTML = `{% include 'components/alert.html' with type='Added' message='Successfully added to cart !' %}`
        }
        if (data.status == 401){
          let alrt = `
          <div class="flex w-full max-w-sm overflow-hidden bg-white rounded-lg shadow-md">
              <div class="flex items-center justify-center w-12 bg-emerald-500">
                <svg class="w-6 h-6 text-white fill-current" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 3.33331C10.8 3.33331 3.33337 10.8 3.33337 20C3.33337 29.2 10.8 36.6666 20 36.6666C29.2 36.6666 36.6667 29.2 36.6667 20C36.6667 10.8 29.2 3.33331 20 3.33331ZM21.6667 28.3333H18.3334V25H21.6667V28.3333ZM21.6667 21.6666H18.3334V11.6666H21.6667V21.6666Z" />
                </svg>
              </div>

              <div class="px-4 py-2 -mx-3">
                  <div class="mx-3">
                      <span class="font-semibold text-black">Oops . . .</span>
                      <p class="text-sm text-black-600 ">You are not authenticated ! <a href="#" class="text-blue">Log in here </a></p>
                      
                  </div>
              </div>
          </div>
          `
          message.innerHTML = alrt
        }
      }
    })
  }


</script>

{% endblock %}